name: Build C# GUI App

on:
  push:
    branches:
      - '*'
  pull_request:
    branches:
      - '*'

jobs:
  run-script:
      runs-on: windows-latest
      steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Set up MSBuild
        uses: microsoft/setup-msbuild@v1

      - name: Set up Arduino CLI
        uses: arduino/setup-arduino-cli@v1
        with:
          version: 0.33.1

      - name: Install Doxygen manually
        shell: cmd
        run: |
              echo Downloading Doxygen...
              curl -LO https://www.doxygen.nl/files/doxygen-1.9.4.windows.x64.bin.zip
              echo Extracting Doxygen...
              powershell -Command "Expand-Archive -Path 'doxygen-1.9.4.windows.x64.bin.zip' -DestinationPath '%cd%\doxygen'"
              echo Adding Doxygen to PATH...
              set PATH=%cd%\doxygen\doxygen-1.9.4.windows.x64\bin;%PATH%
              echo Doxygen installed successfully.


      - name: Run CMD script
        shell: cmd
        run: |
          .\run_local_build.bat COM5 9600

      - name: Upload script results as artifact
        uses: actions/upload-artifact@v3
        with:
          name: script-results
          path: ./artefacts

        

    
   

        

    
   
